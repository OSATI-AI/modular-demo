{
  "task_id": "task_missing_number_grid",
  "template_id": "template_question_answer",
  "title": {
    "english": "Missing Number (Grid)",
    "german": "Fehlende Zahl (Raster)"
  },
  "description": {
    "english": "The student sees a 10x10 grid showing the numbers from 1 to 100. One of the grid cells is empty. The student has to find the missing number.",
    "german": "Der Schüler sieht ein 10x10 Raster, das die Zahlen von 1 bis 100 zeigt. Eine der Rasterzellen ist leer. Der Schüler muss die fehlende Zahl finden."
  },
  "topic_id": 15,
  "events": {
    "send": ["evaluationResult", "task_details", "task_loaded"],
    "receive": ["evaluate", "refresh", "get_task_details"]
  },
  "external_scripts": [
    "missing_number_grid.js"
  ],
  "text": {
    "text_question": {
      "english": "Which number is missing?",
      "german": "Welche Zahl fehlt?"
    },
    "text_answer": {
      "english": "Missing Number",
      "german": "Fehlende Zahl"
    }
  },
  "script": "let answer;\nconst { questionElement, imagePlaceholder, answerElement } = playerApi.callTemplateScript('createLayout', {});\n\nfunction generateExercise() {\n  do {\n    answer = Math.floor(Math.random() * 100) + 1;\n  } while (answer === 0);\n\n  questionElement.innerHTML = \"{{text_question}}\";\n questionElement.setAttribute('text_map', 'text_question');\n  const answerInput = document.createElement(\"input\");\n  answerInput.className = 'input input-bordered w-full max-w-xs';\n  answerInput.id = \"answerField\";\n  const answerSpan = document.createElement(\"span\");\n  const answerLabel = document.createElement(\"p\");\n  answerLabel.innerHTML = \"<b>{{text_answer}}: </b>\";\n answerLabel.setAttribute('text_map', 'text_answer');  answerSpan.append(answerLabel);\n  answerSpan.append(answerInput);\n  answerElement.append(answerSpan);\n\n  plot_missing_number_grid(answer, \"image_placeholder\");\n\n  playerApi.sendEvent('task_loaded', {});\n}\n\nfunction init() {\n  playerApi.receiveEvent('get_task_details', function() {\n    const taskDetails = playerApi.getTaskDetails();\n    const dynamicDetails = `The grid shows all numbers between 1 and 100 except for ${answer}, whose corresponding cell in the grid is empty. Therefore, the missing number and correct answer is ${answer}.`;\n    playerApi.sendEvent('task_details', {\n      staticInfo: taskDetails.description,\n      dynamicDetails: dynamicDetails\n    });\n  });\n\n  playerApi.receiveEvent('evaluate', function() {\n    const userAnswer = parseInt(document.getElementById('answerField').value, 10);\n    const isCorrect = userAnswer === answer;\n    playerApi.sendEvent('evaluationResult', { userAnswer, answer, isCorrect });\n  });\n\n  playerApi.receiveEvent('refresh', function() {\n    answerElement.innerHTML = '';\n    imagePlaceholder.innerHTML = '';\n    generateExercise();\n  });\n}\n\ninit();\ngenerateExercise();"
}
