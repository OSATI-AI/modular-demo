{
  "task_id": "task_fraction_word_selection",
  "template_id": "template_word_selection",
  "title": {
    "english": "Describe the Fraction 2",
    "german": "Beschreibe den Bruch 2"
  },
  "description": {
    "english": "The student has to describe the given fraction by selecting words. The task presents a question, a fraction displayed in the middle of the screen, and multiple word options that the student can select from to form the correct description of the fraction.",
    "german": "Der Schüler muss den gegebenen Bruch durch Auswahl von Wörtern beschreiben. Die Aufgabe stellt eine Frage, zeigt einen Bruch in der Mitte des Bildschirms und bietet mehrere Wortoptionen, aus denen der Schüler die richtige Beschreibung des Bruchs auswählen kann."
  },
  "topic_id": 16,
  "events": {
    "send": ["evaluationResult", "task_details", "task_loaded", "set_words", "set_display"],
    "receive": ["evaluate", "refresh", "get_task_details", "words_selected"]
  },
  "text": {
    "text_question": {
      "english": "How do you read the fraction?",
      "german": "Wie liest du den Bruch?"
    },
    "nom_2": {
      "german": "zwei",
      "english": "two"
    },
    "denom_2": {
      "german": "halbe",
      "english": "half"
    },
    "nom_3": {
      "german": "drei",
      "english": "three"
    },
    "denom_3": {
      "german": "drittel",
      "english": "third"
    },
    "nom_4": {
      "german": "vier",
      "english": "four"
    },
    "denom_4": {
      "german": "viertel",
      "english": "quarter"
    },
    "nom_5": {
      "german": "fünf",
      "english": "five"
    },
    "denom_5": {
      "german": "fünftel",
      "english": "fifth"
    },
    "nom_6": {
      "german": "sechs",
      "english": "six"
    },
    "denom_6": {
      "german": "sechstel",
      "english": "sixth"
    },
    "nom_7": {
      "german": "sieben",
      "english": "seven"
    },
    "denom_7": {
      "german": "siebtel",
      "english": "seventh"
    },
    "nom_8": {
      "german": "acht",
      "english": "eight"
    },
    "denom_8": {
      "german": "achtel",
      "english": "eighth"
    },
    "nom_9": {
      "german": "neun",
      "english": "nine"
    },
    "denom_9": {
      "german": "neuntel",
      "english": "ninth"
    },
    "nom_10": {
      "german": "zehn",
      "english": "ten"
    },
    "denom_10": {
      "german": "zehntel",
      "english": "tenth"
    },
    "nom_11": {
      "german": "elf",
      "english": "eleven"
    },
    "denom_11": {
      "german": "elftel",
      "english": "eleventh"
    },
    "nom_12": {
      "german": "zwölf",
      "english": "twelve"
    },
    "denom_12": {
      "german": "zwölftel",
      "english": "twelfth"
    },
    "hoch": {
      "german": "hoch",
      "english": "high"
    },
    "über": {
      "german": "über",
      "english": "over"
    }
  },
  "script": "let fraction, correctAnswer;\n\n// Call the template's createLayout method to initialize the layout\nconst { questionElement, imagePlaceholder, displayElement, wordContainer, selectedWordsElement } = playerApi.callTemplateScript('createLayout', {});\n\n// Define the words for numerators and denominators\nconst numberWords = {\n  2: { nominator: \"{{nom_2}}\", denominator: \"{{denom_2}}\" },\n  3: { nominator: \"{{nom_3}}\", denominator: \"{{denom_3}}\" },\n  4: { nominator: \"{{nom_4}}\", denominator: \"{{denom_4}}\" },\n  5: { nominator: \"{{nom_5}}\", denominator: \"{{denom_5}}\" },\n  6: { nominator: \"{{nom_6}}\", denominator: \"{{denom_6}}\" },\n  7: { nominator: \"{{nom_7}}\", denominator: \"{{denom_7}}\" },\n  8: { nominator: \"{{nom_8}}\", denominator: \"{{denom_8}}\" },\n  9: { nominator: \"{{nom_9}}\", denominator: \"{{denom_9}}\" },\n  10: { nominator: \"{{nom_10}}\", denominator: \"{{denom_10}}\" },\n  11: { nominator: \"{{nom_11}}\", denominator: \"{{denom_11}}\" },\n  12: { nominator: \"{{nom_12}}\", denominator: \"{{denom_12}}\" }\n};\n\n// Function to generate a new exercise\nfunction generateExercise() {\n  const numerator = Math.floor(Math.random() * 11) + 2;\n  const denominator = Math.floor(Math.random() * 11) + 2;\n\n  fraction = `${numerator}/${denominator}`;\n  correctAnswer = `${numberWords[numerator].nominator} ${numberWords[denominator].denominator}`;\n\n  const displayContent = `<div><sup>${numerator}</sup>&frasl;<sub>${denominator}</sub></div>`;\n\n  const words = [\n    numberWords[numerator].nominator,\n    numberWords[denominator].nominator,\n    numberWords[denominator].denominator,\n    \"{{hoch}}\", \"{{über}}\"\n  ];\n\n  // Add more wrong choices from the other nominator and denominator words to make it harder\n  const extraWords = Object.values(numberWords).flatMap(word => [\n    word.nominator,\n    word.denominator\n  ]).filter(w => !words.includes(w) && w !== undefined);\n\n  while (words.length < 12) { // Ensure there are 12 options to choose from\n    const randomIndex = Math.floor(Math.random() * extraWords.length);\n    words.push(extraWords[randomIndex]);\n    extraWords.splice(randomIndex, 1); // Remove added word to avoid duplicates\n  }\n\n  // Shuffle the words array to randomize the order of choices\n  for (let i = words.length - 1; i > 0; i--) {\n    const j = Math.floor(Math.random() * (i + 1));\n    [words[i], words[j]] = [words[j], words[i]];\n  }\n\n  // Set the question text and display content\n  questionElement.innerText = `{{text_question}}`;\n  displayElement.innerHTML = displayContent;\n  playerApi.sendEvent('set_words', { words: words.filter(w => w) });\n  playerApi.sendEvent('task_loaded', {});\n}\n\n// Function to normalize the answer for comparison\nfunction normalizeAnswer(answer) {\n  return answer.trim().toLowerCase().replace('ö', 'oe').replace('ä', 'ae').replace('ü', 'ue');\n}\n\n// Initialization function\nfunction init() {\n  playerApi.receiveEvent('get_task_details', function() {\n    const taskDetails = playerApi.getTaskDetails();\n    const dynamicDetails = `The task requires selecting the correct words to describe the fraction ${fraction}. The available options are: ${Array.from(document.querySelectorAll('.word-button')).map(button => button.innerText).join(', ')}. The correct answer is: ${correctAnswer}. The currently selected words are: ${selectedWords.join(', ')}.`;\n    playerApi.sendEvent('task_details', {\n      staticInfo: taskDetails.description,\n      dynamicDetails: dynamicDetails\n    });\n  });\n\n  playerApi.receiveEvent('evaluate', function() {\n    const userAnswer = normalizeAnswer(selectedWords.join(' '));\n    const isCorrect = userAnswer === normalizeAnswer(correctAnswer);\n    playerApi.sendEvent('evaluationResult', { userAnswer, correctAnswer, isCorrect });\n  });\n\n  playerApi.receiveEvent('refresh', function() {\n    generateExercise();\n  });\n\n  playerApi.receiveEvent('words_selected', function(event) {\n    selectedWords = event.selectedWords;\n  });\n}\n\n// Initialize and generate the first exercise\ninit();\ngenerateExercise();"
}
