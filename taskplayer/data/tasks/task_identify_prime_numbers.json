{
  "task_id": "task_identify_prime_numbers",
  "template_id": "template_multiple_choice_multi_select",
  "title": {
    "english": "Identify Prime Numbers",
    "german": "Primzahlen erkennen"
  },
  "description": {
    "english": "The student has to identify all prime numbers from a given set of numbers. This is a multiple-choice exercise where multiple selections can be correct. Each multiple choice element contains a checkbox that must be activated to select a number. The task is only correct if all prime numbers are selected and no non-prime numbers are selected.",
    "german": "Der Schüler muss alle Primzahlen aus einer gegebenen Zahlenmenge erkennen. Dies ist eine Multiple-Choice-Aufgabe, bei der mehrere Auswahlen korrekt sein können. Jedes Multiple-Choice-Element enthält ein Kontrollkästchen, das aktiviert werden muss, um eine Zahl auszuwählen. Die Aufgabe ist nur dann korrekt, wenn alle Primzahlen ausgewählt und keine Nicht-Primzahlen ausgewählt werden."
  },
  "topic_id": 19,
  "events": {
    "send": ["evaluationResult", "task_details", "task_loaded"],
    "receive": ["evaluate", "refresh", "get_task_details", "choices_selected"]
  },
  "text": {
    "text_question": {
      "english": "Select all prime numbers: ",
      "german": "Wählen Sie alle Primzahlen aus: "
    }
  },
  "script": "let numbers, correctIds;\nconst NUM_CHOICES = 8;\nlet selectedIds = [];\n\n// Create the layout using the template's method\n// Note: imagePlaceholder is not used in this task and will remain unchanged\nconst { questionElement, imagePlaceholder, choiceElements } = playerApi.callTemplateScript('createLayout', { choices: NUM_CHOICES, choicesData: [] });\n\n// Function to generate the exercise\nfunction generateExercise() {\n  selectedIds = [];\n  do {\n    // Generate random numbers\n    numbers = generateRandomNumbers(NUM_CHOICES);\n    const correctNumbers = numbers.filter(isPrime);\n    correctIds = numbers.map((number, index) => correctNumbers.includes(number) ? index : -1).filter(index => index !== -1);\n  } while (correctIds.length === 0);\n\n  // Set the question text using the variable\n  questionElement.innerText = `{{text_question}}`;\n\n  // Populate the choice elements with the generated numbers\n  numbers.forEach((number, index) => {\n    choiceElements[index].querySelector('label').innerText = number;\n  });\n\n  // Send a task loaded event\n  playerApi.sendEvent('task_loaded', {});\n}\n\n// Function to generate an array of random numbers\nfunction generateRandomNumbers(count) {\n  const numbers = new Set();\n  while (numbers.size < count) {\n    numbers.add(Math.floor(Math.random() * 100) + 1);\n  }\n  return Array.from(numbers);\n}\n\n// Function to check if a number is prime\nfunction isPrime(num) {\n  if (num <= 1) return false;\n  for (let i = 2; i < num; i++) {\n    if (num % i === 0) return false;\n  }\n  return true;\n}\n\n// Initialize event listeners and generate the initial exercise\nfunction init() {\n  // Listener for getting task details\n  playerApi.receiveEvent('get_task_details', function() {\n    const taskDetails = playerApi.getTaskDetails();\n    const dynamicDetails = `The numbers to choose from are: ${numbers}. The correct choices are indices: ${correctIds}.`;\n    playerApi.sendEvent('task_details', {\n      staticInfo: taskDetails.description,\n      dynamicDetails: dynamicDetails\n    });\n  });\n\n  // Listener for evaluating the task\n  playerApi.receiveEvent('evaluate', function() {\n    const isCorrect = selectedIds.length === correctIds.length && selectedIds.every(id => correctIds.includes(id));\n    playerApi.sendEvent('evaluationResult', {\n      selectedIds,\n      isCorrect\n    });\n  });\n\n  // Listener for refreshing the task\n  playerApi.receiveEvent('refresh', function() {\n    choiceElements.forEach(choice => choice.querySelector('input').checked = false);\n    selectedIds = [];\n    generateExercise();\n  });\n\n  // Listener for handling selected choices\n  playerApi.receiveEvent('choices_selected', function(event) {\n    selectedIds = event.map(choice => choice.id);\n  });\n}\n\n// Initialize and generate the exercise\ninit();\ngenerateExercise();"
}
