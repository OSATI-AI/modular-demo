{
    "task_id": "task_fraction_word_selection",
    "template_id": "template_word_selection",
    "title": {
      "english": "Describe the Fraction",
      "german": "Beschreibe den Bruch"
    },
    "description": {
      "english": "The student has to describe the given fraction by selecting words.",
      "german": "Der Schüler muss den gegebenen Bruch durch Auswahl von Wörtern beschreiben."
    },
    "topic_id": 18,
    "events": {
      "send": ["evaluationResult", "task_details", "task_loaded", "set_words", "set_display"],
      "receive": ["evaluate", "refresh", "get_task_details", "words_selected"]
    },
    "text": {
      "text_question": {
        "english": "How do you read the fraction?",
        "german": "Wie liest du den Bruch?"
      }
    },
    "script": "let fraction, correctAnswer;\nconst { questionElement, displayElement, wordContainer, selectedWordsElement } = playerApi.callTemplateScript('createLayout', {});\n\nconst numberWords = {\n  2: { nominator: \"zwei\", denominator: [\"halbe\", \"zweitel\"] },\n  3: { nominator: \"drei\", denominator: [\"drittel\"] },\n  4: { nominator: \"vier\", denominator: [\"viertel\"] },\n  5: { nominator: \"fünf\", denominator: [\"fünftel\"] },\n  6: { nominator: \"sechs\", denominator: [\"sechstel\"] },\n  7: { nominator: \"sieben\", denominator: [\"siebtel\"] },\n  8: { nominator: \"acht\", denominator: [\"achtel\"] },\n  9: { nominator: \"neun\", denominator: [\"neuntel\"] },\n  10: { nominator: \"zehn\", denominator: [\"zehntel\"] },\n  11: { nominator: \"elf\", denominator: [\"elftel\"] },\n  12: { nominator: \"zwölf\", denominator: [\"zwölftel\"] }\n};\n\nfunction generateExercise() {\n  const numerator = Math.floor(Math.random() * 11) + 2;\n  const denominator = Math.floor(Math.random() * 11) + 2;\n\n  fraction = `${numerator}/${denominator}`;\n  correctAnswer = `${numberWords[numerator].nominator} ${numberWords[denominator].denominator[0]}`;\n\n  const displayContent = `<div><sup>${numerator}</sup>&frasl;<sub>${denominator}</sub></div>`;\n\n  const words = [\n    numberWords[numerator].nominator,\n    numberWords[denominator].nominator,\n    numberWords[denominator].denominator[0],\n    numberWords[denominator].denominator[1] ? numberWords[denominator].denominator[1] : '',\n    \"hoch\", \"über\"\n  ];\n\n  // Add more wrong choices from the other nominator and denominator words to make it harder\n  const extraWords = Object.values(numberWords).flatMap(word => [\n    word.nominator,\n    ...word.denominator\n  ]).filter(w => !words.includes(w) && w !== undefined);\n\n  while (words.length < 12) { // Ensure there are 12 options to choose from\n    const randomIndex = Math.floor(Math.random() * extraWords.length);\n    words.push(extraWords[randomIndex]);\n    extraWords.splice(randomIndex, 1); // Remove added word to avoid duplicates\n  }\n\n  // Shuffle the words array to randomize the order of choices\n  for (let i = words.length - 1; i > 0; i--) {\n    const j = Math.floor(Math.random() * (i + 1));\n    [words[i], words[j]] = [words[j], words[i]];\n  }\n\n  playerApi.sendEvent('set_display', { displayContent });\n  playerApi.sendEvent('set_words', { words: words.filter(w => w) });\n  playerApi.sendEvent('task_loaded', {});\n}\n\nfunction normalizeAnswer(answer) {\n  return answer.trim().toLowerCase().replace('ö', 'oe').replace('ä', 'ae').replace('ü', 'ue');\n}\n\nfunction init() {\n  playerApi.receiveEvent('get_task_details', function() {\n    const taskDetails = playerApi.getTaskDetails();\n    const dynamicDetails = `The task requires selecting the correct words to describe the fraction ${fraction}.`;\n    playerApi.sendEvent('task_details', {\n      staticInfo: taskDetails.description,\n      dynamicDetails: dynamicDetails\n    });\n  });\n\n  playerApi.receiveEvent('evaluate', function() {\n    const userAnswer = normalizeAnswer(selectedWords.join(' '));\n    const isCorrect = userAnswer === normalizeAnswer(correctAnswer);\n    playerApi.sendEvent('evaluationResult', { userAnswer, correctAnswer, isCorrect });\n  });\n\n  playerApi.receiveEvent('refresh', function() {\n    generateExercise();\n  });\n\n  playerApi.receiveEvent('words_selected', function(event) {\n    selectedWords = event.selectedWords;\n    console.log('Selected words:', selectedWords);\n  });\n}\n\ninit();\ngenerateExercise();"
  }
  