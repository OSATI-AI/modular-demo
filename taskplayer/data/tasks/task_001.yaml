task_id: "task_001"
template_id: "template_question_answer"
title: "Multiplication Task"
description: "This task requires the user to multiply two numbers together. The user will see a mathematical term with two numbers to multiply and an input field to enter the result."
topic_id: 1
events:
  send: ["evaluationResult", "task_details", "task_loaded"]
  receive: ["evaluate", "refresh", "get_task_details"]
script: |
  let num1, num2;
  const { questionElement, answerElement } = playerApi.callTemplateScript('createLayout', {});


  function generateExercise() {  
    num1 = Math.floor(Math.random() * 10);
    num2 = Math.floor(Math.random() * 10);
    questionElement.innerText = `Multiply: ${num1} x ${num2} = `;
    playerApi.sendEvent('task_loaded', {});
    return { num1, num2 };
  }

  function init(){
    playerApi.receiveEvent('get_task_details', function() {
      const taskDetails = playerApi.getTaskDetails();
      const dynamicDetails = `Current exercise: Multiply ${num1} by ${num2}. Correct result: ${num1 * num2}.`;
      playerApi.sendEvent('task_details', {
        staticInfo: taskDetails.description,
        dynamicDetails: dynamicDetails
      });
    });

    playerApi.receiveEvent('evaluate', function() {
      const userInput = answerElement.value;
      const result = num1 * num2;
      const isCorrect = parseInt(userInput) === result;
      playerApi.sendEvent('evaluationResult', { userInput, result, isCorrect });
    });

    playerApi.receiveEvent('refresh', function() {
      answerElement.value = '';
      generateExercise();
    });
  }
  
  init(); 
  generateExercise();