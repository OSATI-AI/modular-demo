{"task_id": "task_fraction_description", "template_id": "template_fill_in_the_blank", "title": {"english": "Fraction Description", "german": "Bruchbeschreibung"}, "description": {"english": "The student has to fill in the blanks with appropriate terms and numbers to describe the fraction.", "german": "Der Sch\u00fcler muss die L\u00fccken mit passenden Begriffen und Zahlen f\u00fcllen, um den Bruch zu beschreiben."}, "topic_id": 16, "events": {"send": ["evaluationResult", "task_details", "task_loaded"], "receive": ["evaluate", "refresh", "get_task_details"]}, "text": {"text_question": {"english": "Fill in the blanks.", "german": "F\u00fclle die L\u00fccken aus."}}, "script": "let correctAnswers;\nconst { questionElement, fillInTheBlankContainer } = playerApi.callTemplateScript('createLayout', {});\n\nconst numberWords = {\n  2: { nominator: \"zwei\", denominator: [\"halbe\", \"zweitel\"] },\n  3: { nominator: \"drei\", denominator: [\"drittel\"] },\n  4: { nominator: \"vier\", denominator: [\"viertel\"] },\n  5: { nominator: \"f\u00fcnf\", denominator: [\"f\u00fcnftel\"] },\n  6: { nominator: \"sechs\", denominator: [\"sechstel\"] },\n  7: { nominator: \"sieben\", denominator: [\"siebtel\"] },\n  8: { nominator: \"acht\", denominator: [\"achtel\"] },\n  9: { nominator: \"neun\", denominator: [\"neuntel\"] },\n  10: { nominator: \"zehn\", denominator: [\"zehntel\"] },\n  11: { nominator: \"elf\", denominator: [\"elftel\"] },\n  12: { nominator: \"zw\u00f6lf\", denominator: [\"zw\u00f6lftel\"] }\n};\n\nlet numerator, denominator;\n\nfunction generateExercise() {\n  numerator = Math.floor(Math.random() * 11) + 2;\n  denominator = Math.floor(Math.random() * 11) + 2;\n\n  correctAnswers = {\n    'fraction': [\n      `${numberWords[numerator].nominator} ${numberWords[denominator].denominator[0]}`,\n      `${numberWords[numerator].nominator} ${numberWords[denominator].denominator[1]}`,\n      `${numerator}/${denominator}`\n    ],\n    'denominator': [denominator.toString(), numberWords[denominator].nominator],\n    'numerator': [numerator.toString(), numberWords[numerator].nominator]\n  };\n\n  questionElement.innerText = \"{{text_question}}\";\n  const content = `\n    <div>Man schreibt es so: <sup>${numerator}</sup>&frasl;<sub>${denominator}</sub></div>\n    <div>Man spricht es so: <input type='text' id='fraction' class='blank'>.</div>\n    <div>\"Die <input type='text' id='denominator' class='blank'> sagt, in wie viele gleich gro\u00dfe Teile man die Schokolade teilt.</div>\n    <div>Die <input type='text' id='numerator' class='blank'> gibt an, wie viele dieser Teile man davon nimmt.\"</div>\n  `;\n  fillInTheBlankContainer.innerHTML = content;\n  playerApi.sendEvent('task_loaded', {});\n}\n\nfunction normalizeAnswer(answer) {\n  return answer.trim().toLowerCase();\n}\n\nfunction init() {\n  playerApi.receiveEvent('get_task_details', function() {\n    const taskDetails = playerApi.getTaskDetails();\n    const dynamicDetails = `The task requires filling in the blanks correctly to describe the fraction ${numerator}/${denominator}.`;\n    playerApi.sendEvent('task_details', {\n      staticInfo: taskDetails.description,\n      dynamicDetails: dynamicDetails\n    });\n  });\n\n  playerApi.receiveEvent('evaluate', function() {\n    const userAnswers = {\n      'fraction': normalizeAnswer(document.getElementById('fraction').value),\n      'denominator': normalizeAnswer(document.getElementById('denominator').value),\n      'numerator': normalizeAnswer(document.getElementById('numerator').value)\n    };\n    console.log(userAnswers);\n    console.log(correctAnswers);\n    const isCorrect = Object.keys(correctAnswers).every(key => {\n      return correctAnswers[key].includes(userAnswers[key]);\n    });\n    playerApi.sendEvent('evaluationResult', { userAnswers, correctAnswers, isCorrect });\n  });\n\n  playerApi.receiveEvent('refresh', function() {\n    fillInTheBlankContainer.innerHTML = '';\n    generateExercise();\n  });\n}\n\ninit();\ngenerateExercise();"}